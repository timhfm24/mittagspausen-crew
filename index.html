<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>EP Mittagspausen Crew</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f7f7;
      text-align: center;
      padding: 2rem;
    }
    button {
      margin: 1rem;
      padding: 1rem 2rem;
      font-size: 1.2rem;
      border-radius: 10px;
      border: none;
      cursor: pointer;
    }
    #chosen {
      font-size: 2rem;
      margin-top: 2rem;
      font-weight: bold;
    }
    .secondary {
      background-color: #ccc;
    }
  </style>
</head>
<body>
  <h1>üçΩÔ∏è EP Mittagspausen Crew</h1>
  <p>Klicke, um ein zuf√§lliges Restaurant auszuw√§hlen (mit 14-Tage-Abstand).</p>
  <button onclick="chooseRestaurant()">Restaurant w√§hlen</button>
  <button class="secondary" onclick="resetHistory()">Z√§hler zur√ºcksetzen</button>
  <div id="chosen"></div>

  <script>
    const restaurants = [
      "Gondel",
      "Nem & More",
      "La Pho",
      "Chicken Box D√∂ner",
      "Pizza Gondel",
      "Don Sushi",
      "Burgers Burgers",
      "Babil Shawarma",
      "Mittmanns"
    ];
    const MIN_DAYS = 14;

    function getHistory() {
      return JSON.parse(localStorage.getItem("visitHistory") || "{}");
    }

    function saveVisit(name) {
      const history = getHistory();
      history[name] = new Date().toISOString();
      localStorage.setItem("visitHistory", JSON.stringify(history));
    }

    function daysSince(dateStr) {
      const past = new Date(dateStr);
      const now = new Date();
      const diff = (now - past) / (1000 * 60 * 60 * 24);
      return Math.floor(diff);
    }

    function chooseRestaurant() {
      const history = getHistory();
      const eligible = restaurants.filter(r =>
        !history[r] || daysSince(history[r]) >= MIN_DAYS
      );

      if (eligible.length === 0) {
        document.getElementById("chosen").textContent = "‚ùå Kein Restaurant erf√ºllt den 14-Tage-Abstand.";
        return;
      }

      const chosen = eligible[Math.floor(Math.random() * eligible.length)];
      saveVisit(chosen);
      document.getElementById("chosen").textContent = `‚úÖ Heute geht's zu: ${chosen}`;
    }

    function resetHistory() {
      localStorage.clear();
      alert("Der Z√§hler wurde zur√ºckgesetzt!");
      location.reload();
    }
  </script>
</body>
</html>
